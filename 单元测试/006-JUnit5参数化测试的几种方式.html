

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>JUnit5参数化测试的几种方式 &mdash; 测试开发刚哥 latest documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/js/readmore.js"></script>
        <script src="../_static/js/baidutongji.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="JUnit5依赖注入与测试接口" href="007-JUnit5%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E4%B8%8E%E6%B5%8B%E8%AF%95%E6%8E%A5%E5%8F%A3.html" />
    <link rel="prev" title="JUnit5的条件测试、嵌套测试、重复测试" href="005-JUnit5%E7%9A%84%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95%E3%80%81%E5%B5%8C%E5%A5%97%E6%B5%8B%E8%AF%95%E3%80%81%E9%87%8D%E5%A4%8D%E6%B5%8B%E8%AF%95.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> 测试开发刚哥
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../%E8%87%AA%E6%88%91%E4%BB%8B%E7%BB%8D.html">自我介绍</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E4%BD%93%E7%B3%BB.html">测试体系</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E7%94%A8%E4%BE%8B%E8%AE%BE%E8%AE%A1.html">用例设计</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80.html">编程语言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%8E%A5%E5%8F%A3%E8%87%AA%E5%8A%A8.html">接口自动</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E7%99%BD%E7%9B%92%E6%B5%8B%E8%AF%95.html">白盒测试</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../chapters/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95.html">单元测试</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="001-Java%E6%96%B0%E4%B8%80%E4%BB%A3%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6JUnit5%E9%80%9F%E8%A7%88.html">Java新一代单元测试框架JUnit5速览</a></li>
<li class="toctree-l2"><a class="reference internal" href="002-JUnit5%E6%B3%A8%E8%A7%A3%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%BC%95.html">JUnit5注解学习指引</a></li>
<li class="toctree-l2"><a class="reference internal" href="003-JUnit5%E7%BC%96%E5%86%99%E5%9F%BA%E6%9C%AC%E6%B5%8B%E8%AF%95.html">JUnit5编写基本测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="004-JUnit5%E7%9A%84Tag%E3%80%81Filter%E3%80%81Order%E3%80%81Lifecycle.html">JUnit5的Tag、Filter、Order、Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="005-JUnit5%E7%9A%84%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95%E3%80%81%E5%B5%8C%E5%A5%97%E6%B5%8B%E8%AF%95%E3%80%81%E9%87%8D%E5%A4%8D%E6%B5%8B%E8%AF%95.html">JUnit5的条件测试、嵌套测试、重复测试</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">JUnit5参数化测试的几种方式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">依赖</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">简单示例</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">七种方式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#valuesource">1 <code class="docutils literal notranslate"><span class="pre">&#64;ValueSource</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#null-and-empty-sources">2 Null and Empty Sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="#enumsource">3 <code class="docutils literal notranslate"><span class="pre">&#64;EnumSource</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#methodsource">4 <code class="docutils literal notranslate"><span class="pre">&#64;MethodSource</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#csvsource">5 <code class="docutils literal notranslate"><span class="pre">&#64;CsvSource</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#csvfilesource">6 <code class="docutils literal notranslate"><span class="pre">&#64;CsvFileSource</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#argumentssource">7 <code class="docutils literal notranslate"><span class="pre">&#64;ArgumentsSource</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id4">参数类型转换</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">隐式转换</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">显式转换</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id7">参数聚合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">自定义显示名字</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">小结</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="007-JUnit5%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E4%B8%8E%E6%B5%8B%E8%AF%95%E6%8E%A5%E5%8F%A3.html">JUnit5依赖注入与测试接口</a></li>
<li class="toctree-l2"><a class="reference internal" href="201-Java%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95Mock%E6%A1%86%E6%9E%B6Mockito%E5%85%A5%E9%97%A8%E4%BB%8B%E7%BB%8D.html">Java单元测试Mock框架Mockito入门介绍</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E7%B2%BE%E5%87%86%E6%B5%8B%E8%AF%95.html">精准测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83.html">测试环境</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6.html">测试框架</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7.html">测试工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0.html">测试平台</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A.html">测试报告</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%81%E9%87%8F%E5%9B%9E%E6%94%BE.html">流量回放</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95.html">性能测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6.html">开发框架</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E4%B8%AD%E9%97%B4%E8%BD%AF%E4%BB%B6.html">中间软件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E9%80%9A%E7%94%A8%E6%8A%80%E6%9C%AF.html">通用技术</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E9%9D%A2%E8%AF%95%E5%A4%87%E6%88%98.html">面试备战</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%80%BB%E7%BB%93%E6%84%9F%E6%83%B3.html">总结感想</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">测试开发刚哥</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../chapters/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95.html">单元测试</a> &raquo;</li>
        
      <li>JUnit5参数化测试的几种方式</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/单元测试/006-JUnit5参数化测试的几种方式.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="junit5">
<h1>JUnit5参数化测试的几种方式<a class="headerlink" href="#junit5" title="Permalink to this headline">¶</a></h1>
<p><img alt="image1" src="../_images/wanggang1.png" /></p>
<p>参数化测试一直是津津乐道的话题，我们都知道JMeter有四种参数化方式：用户自定义变量、用户参数、CSV文件、函数助手，那么JUnit5有哪些参数化测试的方式呢？</p>
<div class="section" id="id1">
<h2>依赖<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>JUnit5需要添加<code class="docutils literal notranslate"><span class="pre">junit-jupiter-params</span></code>依赖才能使用参数化：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.junit.jupiter<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>junit-jupiter-params<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>5.7.2<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h2>简单示例<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">&#64;ParameterizedTest</span></code>用来定义参数化测试，<code class="docutils literal notranslate"><span class="pre">&#64;ValueSource</span></code>用来定义参数值：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="p">(</span><span class="n">strings</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;racecar&quot;</span><span class="p">,</span> <span class="s">&quot;radar&quot;</span><span class="p">,</span> <span class="s">&quot;able was I ere I saw elba&quot;</span> <span class="p">})</span>
<span class="kt">void</span> <span class="nf">palindromes</span><span class="p">(</span><span class="n">String</span> <span class="n">candidate</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertTrue</span><span class="p">(</span><span class="n">StringUtils</span><span class="p">.</span><span class="na">isPalindrome</span><span class="p">(</span><span class="n">candidate</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>执行结果：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>palindromes(String) ✔
├─ [1] candidate=racecar ✔
├─ [2] candidate=radar ✔
└─ [3] candidate=able was I ere I saw elba ✔
</pre></div>
</div>
<p>参数值会匹配测试方法的参数列表，然后依次赋值，这里一共产生了3个测试。</p>
</div>
<div class="section" id="id3">
<h2>七种方式<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="section" id="valuesource">
<h3>1 <code class="docutils literal notranslate"><span class="pre">&#64;ValueSource</span></code><a class="headerlink" href="#valuesource" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">&#64;ValueSource</span></code>是最简单的参数化方式，它是一个数组，支持以下数据类型：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">short</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">byte</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">long</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">char</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">java.lang.String</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">java.lang.Class</span></code></p></li>
</ul>
<p>示例：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="p">(</span><span class="n">ints</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">})</span>
<span class="kt">void</span> <span class="nf">testWithValueSource</span><span class="p">(</span><span class="kt">int</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertTrue</span><span class="p">(</span><span class="n">argument</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">argument</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="null-and-empty-sources">
<h3>2 Null and Empty Sources<a class="headerlink" href="#null-and-empty-sources" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;NullSource</span></code> 值为null</p>
<blockquote>
<div><p>不能用在基元类型的测试方法。</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;EmptySource</span></code>
值为空，根据测试方法的参数类决定数据类型，支持<code class="docutils literal notranslate"><span class="pre">java.lang.String</span></code>,
<code class="docutils literal notranslate"><span class="pre">java.util.List</span></code>, <code class="docutils literal notranslate"><span class="pre">java.util.Set</span></code>, <code class="docutils literal notranslate"><span class="pre">java.util.Map</span></code>,
基元类型数组 (<code class="docutils literal notranslate"><span class="pre">int[]</span></code>, <code class="docutils literal notranslate"><span class="pre">char[][]</span></code>等), 对象数组 (<code class="docutils literal notranslate"><span class="pre">String[]</span></code>,
<code class="docutils literal notranslate"><span class="pre">Integer[][]</span></code>等)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;NullAndEmptySource</span></code> 结合了前面两个</p></li>
</ul>
<p>示例：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@NullSource</span>
<span class="nd">@EmptySource</span>
<span class="nd">@ValueSource</span><span class="p">(</span><span class="n">strings</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="s">&quot;   &quot;</span><span class="p">,</span> <span class="s">&quot;\t&quot;</span><span class="p">,</span> <span class="s">&quot;\n&quot;</span> <span class="p">})</span>
<span class="kt">void</span> <span class="nf">nullEmptyAndBlankStrings</span><span class="p">(</span><span class="n">String</span> <span class="n">text</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertTrue</span><span class="p">(</span><span class="n">text</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">text</span><span class="p">.</span><span class="na">trim</span><span class="p">().</span><span class="na">isEmpty</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>等价于：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@NullAndEmptySource</span>
<span class="nd">@ValueSource</span><span class="p">(</span><span class="n">strings</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="s">&quot;   &quot;</span><span class="p">,</span> <span class="s">&quot;\t&quot;</span><span class="p">,</span> <span class="s">&quot;\n&quot;</span> <span class="p">})</span>
<span class="kt">void</span> <span class="nf">nullEmptyAndBlankStrings</span><span class="p">(</span><span class="n">String</span> <span class="n">text</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertTrue</span><span class="p">(</span><span class="n">text</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">text</span><span class="p">.</span><span class="na">trim</span><span class="p">().</span><span class="na">isEmpty</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="enumsource">
<h3>3 <code class="docutils literal notranslate"><span class="pre">&#64;EnumSource</span></code><a class="headerlink" href="#enumsource" title="Permalink to this headline">¶</a></h3>
<p>参数化的值为枚举类型。</p>
<p>示例：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@EnumSource</span>
<span class="kt">void</span> <span class="nf">testWithEnumSourceWithAutoDetection</span><span class="p">(</span><span class="n">ChronoUnit</span> <span class="n">unit</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertNotNull</span><span class="p">(</span><span class="n">unit</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>其中的ChronoUnit是个日期枚举类。</p>
<p>ChronoUnit是接口TemporalUnit的实现类，如果测试方法的参数为TemporalUnit，那么需要给<code class="docutils literal notranslate"><span class="pre">&#64;EnumSource</span></code>加上值：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@EnumSource</span><span class="p">(</span><span class="n">ChronoUnit</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="kt">void</span> <span class="nf">testWithEnumSource</span><span class="p">(</span><span class="n">TemporalUnit</span> <span class="n">unit</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertNotNull</span><span class="p">(</span><span class="n">unit</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>因为JUnit5规定了<code class="docutils literal notranslate"><span class="pre">&#64;EnumSource</span></code>的默认值的类型必须是枚举类型。</p>
<p>names属性用来指定使用哪些特定的枚举值：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@EnumSource</span><span class="p">(</span><span class="n">names</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;DAYS&quot;</span><span class="p">,</span> <span class="s">&quot;HOURS&quot;</span> <span class="p">})</span>
<span class="kt">void</span> <span class="nf">testWithEnumSourceInclude</span><span class="p">(</span><span class="n">ChronoUnit</span> <span class="n">unit</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertTrue</span><span class="p">(</span><span class="n">EnumSet</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">ChronoUnit</span><span class="p">.</span><span class="na">DAYS</span><span class="p">,</span> <span class="n">ChronoUnit</span><span class="p">.</span><span class="na">HOURS</span><span class="p">).</span><span class="na">contains</span><span class="p">(</span><span class="n">unit</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>mode属性用来指定使用模式，比如排除哪些枚举值：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@EnumSource</span><span class="p">(</span><span class="n">mode</span> <span class="o">=</span> <span class="n">EXCLUDE</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;ERAS&quot;</span><span class="p">,</span> <span class="s">&quot;FOREVER&quot;</span> <span class="p">})</span>
<span class="kt">void</span> <span class="nf">testWithEnumSourceExclude</span><span class="p">(</span><span class="n">ChronoUnit</span> <span class="n">unit</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertFalse</span><span class="p">(</span><span class="n">EnumSet</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">ChronoUnit</span><span class="p">.</span><span class="na">ERAS</span><span class="p">,</span> <span class="n">ChronoUnit</span><span class="p">.</span><span class="na">FOREVER</span><span class="p">).</span><span class="na">contains</span><span class="p">(</span><span class="n">unit</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>比如采用正则匹配：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@EnumSource</span><span class="p">(</span><span class="n">mode</span> <span class="o">=</span> <span class="n">MATCH_ALL</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="s">&quot;^.*DAYS$&quot;</span><span class="p">)</span>
<span class="kt">void</span> <span class="nf">testWithEnumSourceRegex</span><span class="p">(</span><span class="n">ChronoUnit</span> <span class="n">unit</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertTrue</span><span class="p">(</span><span class="n">unit</span><span class="p">.</span><span class="na">name</span><span class="p">().</span><span class="na">endsWith</span><span class="p">(</span><span class="s">&quot;DAYS&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="methodsource">
<h3>4 <code class="docutils literal notranslate"><span class="pre">&#64;MethodSource</span></code><a class="headerlink" href="#methodsource" title="Permalink to this headline">¶</a></h3>
<p>参数值为factory方法，并且factory方法不能带参数。</p>
<p>示例：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@MethodSource</span><span class="p">(</span><span class="s">&quot;stringProvider&quot;</span><span class="p">)</span>
<span class="kt">void</span> <span class="nf">testWithExplicitLocalMethodSource</span><span class="p">(</span><span class="n">String</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertNotNull</span><span class="p">(</span><span class="n">argument</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">static</span> <span class="n">Stream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">stringProvider</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;apple&quot;</span><span class="p">,</span> <span class="s">&quot;banana&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>除非是<code class="docutils literal notranslate"><span class="pre">&#64;TestInstance(Lifecycle.PER_CLASS)</span></code>生命周期，否则factory方法必须是static。factory方法的返回值是能转换为<code class="docutils literal notranslate"><span class="pre">Stream</span></code>的类型，比如<code class="docutils literal notranslate"><span class="pre">Stream</span></code>,
<code class="docutils literal notranslate"><span class="pre">DoubleStream</span></code>, <code class="docutils literal notranslate"><span class="pre">LongStream</span></code>, <code class="docutils literal notranslate"><span class="pre">IntStream</span></code>, <code class="docutils literal notranslate"><span class="pre">Collection</span></code>,
<code class="docutils literal notranslate"><span class="pre">Iterator</span></code>, <code class="docutils literal notranslate"><span class="pre">Iterable</span></code>, 对象数组, 或者基元类型数组，比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@MethodSource</span><span class="p">(</span><span class="s">&quot;range&quot;</span><span class="p">)</span>
<span class="kt">void</span> <span class="nf">testWithRangeMethodSource</span><span class="p">(</span><span class="kt">int</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertNotEquals</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">argument</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">static</span> <span class="n">IntStream</span> <span class="nf">range</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">IntStream</span><span class="p">.</span><span class="na">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">).</span><span class="na">skip</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&#64;MethodSource</span></code>的属性如果省略了，那么JUnit
Jupiter会找跟测试方法同名的factory方法，比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@MethodSource</span>
<span class="kt">void</span> <span class="nf">testWithDefaultLocalMethodSource</span><span class="p">(</span><span class="n">String</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertNotNull</span><span class="p">(</span><span class="n">argument</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">static</span> <span class="n">Stream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">testWithDefaultLocalMethodSource</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;apple&quot;</span><span class="p">,</span> <span class="s">&quot;banana&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>如果测试方法有多个参数，那么factory方法也应该返回多个：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@MethodSource</span><span class="p">(</span><span class="s">&quot;stringIntAndListProvider&quot;</span><span class="p">)</span>
<span class="kt">void</span> <span class="nf">testWithMultiArgMethodSource</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num</span><span class="p">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertEquals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">str</span><span class="p">.</span><span class="na">length</span><span class="p">());</span>
    <span class="n">assertTrue</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;=</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">num</span> <span class="o">&lt;=</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">assertEquals</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">list</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<span class="p">}</span>

<span class="kd">static</span> <span class="n">Stream</span><span class="o">&lt;</span><span class="n">Arguments</span><span class="o">&gt;</span> <span class="nf">stringIntAndListProvider</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
        <span class="n">arguments</span><span class="p">(</span><span class="s">&quot;apple&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">)),</span>
        <span class="n">arguments</span><span class="p">(</span><span class="s">&quot;lemon&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">))</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>其中<code class="docutils literal notranslate"><span class="pre">arguments(Object…)</span></code>是Arguments接口的static factory
method，也可以换成<code class="docutils literal notranslate"><span class="pre">Arguments.of(Object…)</span></code>。</p>
<p>factory方法也可以防止测试类外部：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">example</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.stream.Stream</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.params.ParameterizedTest</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.params.provider.MethodSource</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">ExternalMethodSourceDemo</span> <span class="p">{</span>

    <span class="nd">@ParameterizedTest</span>
    <span class="nd">@MethodSource</span><span class="p">(</span><span class="s">&quot;example.StringsProviders#tinyStrings&quot;</span><span class="p">)</span>
    <span class="kt">void</span> <span class="nf">testWithExternalMethodSource</span><span class="p">(</span><span class="n">String</span> <span class="n">tinyString</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// test with tiny string</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">StringsProviders</span> <span class="p">{</span>

    <span class="kd">static</span> <span class="n">Stream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">tinyStrings</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">,</span> <span class="s">&quot;oo&quot;</span><span class="p">,</span> <span class="s">&quot;OOO&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="csvsource">
<h3>5 <code class="docutils literal notranslate"><span class="pre">&#64;CsvSource</span></code><a class="headerlink" href="#csvsource" title="Permalink to this headline">¶</a></h3>
<p>参数化的值为csv格式的数据（默认逗号分隔），比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvSource</span><span class="p">({</span>
    <span class="s">&quot;apple,         1&quot;</span><span class="p">,</span>
    <span class="s">&quot;banana,        2&quot;</span><span class="p">,</span>
    <span class="s">&quot;&#39;lemon, lime&#39;, 0xF1&quot;</span>
<span class="p">})</span>
<span class="kt">void</span> <span class="nf">testWithCsvSource</span><span class="p">(</span><span class="n">String</span> <span class="n">fruit</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rank</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertNotNull</span><span class="p">(</span><span class="n">fruit</span><span class="p">);</span>
    <span class="n">assertNotEquals</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rank</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>delimiter属性可以设置分隔字符。delimiterString属性可以设置分隔字符串（String而非char）。</p>
<p>更多输入输出示例如下：</p>
<p><img alt="image2" src="../_images/image-20210714140242605.png" /></p>
<p>注意，如果null引用的目标类型是基元类型，那么会报异常<code class="docutils literal notranslate"><span class="pre">ArgumentConversionException</span></code>。</p>
</div>
<div class="section" id="csvfilesource">
<h3>6 <code class="docutils literal notranslate"><span class="pre">&#64;CsvFileSource</span></code><a class="headerlink" href="#csvfilesource" title="Permalink to this headline">¶</a></h3>
<p>顾名思义，选择本地csv文件作为数据来源。</p>
<p>示例：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvFileSource</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="s">&quot;/two-column.csv&quot;</span><span class="p">,</span> <span class="n">numLinesToSkip</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="kt">void</span> <span class="nf">testWithCsvFileSourceFromClasspath</span><span class="p">(</span><span class="n">String</span> <span class="n">country</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reference</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertNotNull</span><span class="p">(</span><span class="n">country</span><span class="p">);</span>
    <span class="n">assertNotEquals</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">reference</span><span class="p">);</span>
<span class="p">}</span>

<span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvFileSource</span><span class="p">(</span><span class="n">files</span> <span class="o">=</span> <span class="s">&quot;src/test/resources/two-column.csv&quot;</span><span class="p">,</span> <span class="n">numLinesToSkip</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="kt">void</span> <span class="nf">testWithCsvFileSourceFromFile</span><span class="p">(</span><span class="n">String</span> <span class="n">country</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reference</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertNotNull</span><span class="p">(</span><span class="n">country</span><span class="p">);</span>
    <span class="n">assertNotEquals</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">reference</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>delimiter属性可以设置分隔字符。delimiterString属性可以设置分隔字符串（String而非char）。<strong>需要特别注意的是，``#``开头的行会被认为是注释而略过。</strong></p>
</div>
<div class="section" id="argumentssource">
<h3>7 <code class="docutils literal notranslate"><span class="pre">&#64;ArgumentsSource</span></code><a class="headerlink" href="#argumentssource" title="Permalink to this headline">¶</a></h3>
<p>自定义ArgumentsProvider。</p>
<p>示例：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@ArgumentsSource</span><span class="p">(</span><span class="n">MyArgumentsProvider</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="kt">void</span> <span class="nf">testWithArgumentsSource</span><span class="p">(</span><span class="n">String</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertNotNull</span><span class="p">(</span><span class="n">argument</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyArgumentsProvider</span> <span class="kd">implements</span> <span class="n">ArgumentsProvider</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Stream</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Arguments</span><span class="o">&gt;</span> <span class="nf">provideArguments</span><span class="p">(</span><span class="n">ExtensionContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;apple&quot;</span><span class="p">,</span> <span class="s">&quot;banana&quot;</span><span class="p">).</span><span class="na">map</span><span class="p">(</span><span class="n">Arguments</span><span class="p">::</span><span class="n">of</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>MyArgumentsProvider必须是外部类或者static内部类。</p>
</div>
</div>
<div class="section" id="id4">
<h2>参数类型转换<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id5">
<h3>隐式转换<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>JUnit Jupiter会对String类型进行隐式转换。比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="p">(</span><span class="n">strings</span> <span class="o">=</span> <span class="s">&quot;SECONDS&quot;</span><span class="p">)</span>
<span class="kt">void</span> <span class="nf">testWithImplicitArgumentConversion</span><span class="p">(</span><span class="n">ChronoUnit</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertNotNull</span><span class="p">(</span><span class="n">argument</span><span class="p">.</span><span class="na">name</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>更多转换示例：</p>
<p><img alt="image3" src="../_images/image-20210714143735484.png" /></p>
<p><img alt="image4" src="../_images/Dingtalk_20210714143207.jpg" /></p>
<p>也可以把String转换为自定义对象：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="p">(</span><span class="n">strings</span> <span class="o">=</span> <span class="s">&quot;42 Cats&quot;</span><span class="p">)</span>
<span class="kt">void</span> <span class="nf">testWithImplicitFallbackArgumentConversion</span><span class="p">(</span><span class="n">Book</span> <span class="n">book</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">assertEquals</span><span class="p">(</span><span class="s">&quot;42 Cats&quot;</span><span class="p">,</span> <span class="n">book</span><span class="p">.</span><span class="na">getTitle</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Book</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">title</span><span class="p">;</span>

    <span class="kd">private</span> <span class="nf">Book</span><span class="p">(</span><span class="n">String</span> <span class="n">title</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Book</span> <span class="nf">fromTitle</span><span class="p">(</span><span class="n">String</span> <span class="n">title</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Book</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTitle</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="na">title</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>JUnit
Jupiter会找到<code class="docutils literal notranslate"><span class="pre">Book.fromTitle(String)</span></code>方法，然后把<code class="docutils literal notranslate"><span class="pre">&#64;ValueSource</span></code>的值传入进去，进而把String类型转换为Book类型。转换的factory方法既可以是接受单个String参数的构造方法，也可以是接受单个String参数并返回目标类型的普通方法。详细规则如下（官方原文）：</p>
<p><img alt="image5" src="../_images/image-20210714145601731.png" /></p>
</div>
<div class="section" id="id6">
<h3>显式转换<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>显式转换需要使用<code class="docutils literal notranslate"><span class="pre">&#64;ConvertWith</span></code>注解：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@EnumSource</span><span class="p">(</span><span class="n">ChronoUnit</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="kt">void</span> <span class="nf">testWithExplicitArgumentConversion</span><span class="p">(</span>
        <span class="nd">@ConvertWith</span><span class="p">(</span><span class="n">ToStringArgumentConverter</span><span class="p">.</span><span class="na">class</span><span class="p">)</span> <span class="n">String</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>

    <span class="n">assertNotNull</span><span class="p">(</span><span class="n">ChronoUnit</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">argument</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>并实现ArgumentConverter：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ToStringArgumentConverter</span> <span class="kd">extends</span> <span class="n">SimpleArgumentConverter</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">Object</span> <span class="nf">convert</span><span class="p">(</span><span class="n">Object</span> <span class="n">source</span><span class="p">,</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">targetType</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">assertEquals</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">targetType</span><span class="p">,</span> <span class="s">&quot;Can only convert to String&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">source</span> <span class="k">instanceof</span> <span class="n">Enum</span><span class="o">&lt;?&gt;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="p">((</span><span class="n">Enum</span><span class="o">&lt;?&gt;</span><span class="p">)</span> <span class="n">source</span><span class="p">).</span><span class="na">name</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>如果只是简单类型转换，实现TypedArgumentConverter即可：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ToLengthArgumentConverter</span> <span class="kd">extends</span> <span class="n">TypedArgumentConverter</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="kd">protected</span> <span class="nf">ToLengthArgumentConverter</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Integer</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">Integer</span> <span class="nf">convert</span><span class="p">(</span><span class="n">String</span> <span class="n">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">source</span><span class="p">.</span><span class="na">length</span><span class="p">();</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>JUnit
Jupiter只内置了一个JavaTimeArgumentConverter，通过<code class="docutils literal notranslate"><span class="pre">&#64;JavaTimeConversionPattern</span></code>使用：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="p">(</span><span class="n">strings</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;01.01.2017&quot;</span><span class="p">,</span> <span class="s">&quot;31.12.2017&quot;</span> <span class="p">})</span>
<span class="kt">void</span> <span class="nf">testWithExplicitJavaTimeConverter</span><span class="p">(</span>
        <span class="nd">@JavaTimeConversionPattern</span><span class="p">(</span><span class="s">&quot;dd.MM.yyyy&quot;</span><span class="p">)</span> <span class="n">LocalDate</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>

    <span class="n">assertEquals</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="n">argument</span><span class="p">.</span><span class="na">getYear</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id7">
<h2>参数聚合<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>测试方法的多个参数可以聚合为一个ArgumentsAccessor参数，然后通过get来取值，示例：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvSource</span><span class="p">({</span>
    <span class="s">&quot;Jane, Doe, F, 1990-05-20&quot;</span><span class="p">,</span>
    <span class="s">&quot;John, Doe, M, 1990-10-22&quot;</span>
<span class="p">})</span>
<span class="kt">void</span> <span class="nf">testWithArgumentsAccessor</span><span class="p">(</span><span class="n">ArgumentsAccessor</span> <span class="n">arguments</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Person</span> <span class="n">person</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="n">arguments</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                               <span class="n">arguments</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                               <span class="n">arguments</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Gender</span><span class="p">.</span><span class="na">class</span><span class="p">),</span>
                               <span class="n">arguments</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">LocalDate</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">person</span><span class="p">.</span><span class="na">getFirstName</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;Jane&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">assertEquals</span><span class="p">(</span><span class="n">Gender</span><span class="p">.</span><span class="na">F</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="na">getGender</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="n">assertEquals</span><span class="p">(</span><span class="n">Gender</span><span class="p">.</span><span class="na">M</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="na">getGender</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="n">assertEquals</span><span class="p">(</span><span class="s">&quot;Doe&quot;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="na">getLastName</span><span class="p">());</span>
    <span class="n">assertEquals</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="na">getDateOfBirth</span><span class="p">().</span><span class="na">getYear</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>也可以自定义Aggregator：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PersonAggregator</span> <span class="kd">implements</span> <span class="n">ArgumentsAggregator</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Person</span> <span class="nf">aggregateArguments</span><span class="p">(</span><span class="n">ArgumentsAccessor</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">ParameterContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="n">arguments</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                          <span class="n">arguments</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                          <span class="n">arguments</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Gender</span><span class="p">.</span><span class="na">class</span><span class="p">),</span>
                          <span class="n">arguments</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">LocalDate</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>然后通过<code class="docutils literal notranslate"><span class="pre">&#64;AggregateWith</span></code>来使用：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvSource</span><span class="p">({</span>
    <span class="s">&quot;Jane, Doe, F, 1990-05-20&quot;</span><span class="p">,</span>
    <span class="s">&quot;John, Doe, M, 1990-10-22&quot;</span>
<span class="p">})</span>
<span class="kt">void</span> <span class="nf">testWithArgumentsAggregator</span><span class="p">(</span><span class="nd">@AggregateWith</span><span class="p">(</span><span class="n">PersonAggregator</span><span class="p">.</span><span class="na">class</span><span class="p">)</span> <span class="n">Person</span> <span class="n">person</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// perform assertions against person</span>
<span class="p">}</span>
</pre></div>
</div>
<p>借助于组合注解，我们可以进一步简化代码：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Retention</span><span class="p">(</span><span class="n">RetentionPolicy</span><span class="p">.</span><span class="na">RUNTIME</span><span class="p">)</span>
<span class="nd">@Target</span><span class="p">(</span><span class="n">ElementType</span><span class="p">.</span><span class="na">PARAMETER</span><span class="p">)</span>
<span class="nd">@AggregateWith</span><span class="p">(</span><span class="n">PersonAggregator</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">CsvToPerson</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvSource</span><span class="p">({</span>
    <span class="s">&quot;Jane, Doe, F, 1990-05-20&quot;</span><span class="p">,</span>
    <span class="s">&quot;John, Doe, M, 1990-10-22&quot;</span>
<span class="p">})</span>
<span class="kt">void</span> <span class="nf">testWithCustomAggregatorAnnotation</span><span class="p">(</span><span class="nd">@CsvToPerson</span> <span class="n">Person</span> <span class="n">person</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// perform assertions against person</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h2>自定义显示名字<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>参数化测试生成的test，JUnit
Jupiter给定了默认名字，我们可以通过name属性进行自定义。</p>
<p>示例：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;Display name of container&quot;</span><span class="p">)</span>
<span class="nd">@ParameterizedTest</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;{index} ==&gt; the rank of &#39;&#39;{0}&#39;&#39; is {1}&quot;</span><span class="p">)</span>
<span class="nd">@CsvSource</span><span class="p">({</span> <span class="s">&quot;apple, 1&quot;</span><span class="p">,</span> <span class="s">&quot;banana, 2&quot;</span><span class="p">,</span> <span class="s">&quot;&#39;lemon, lime&#39;, 3&quot;</span> <span class="p">})</span>
<span class="kt">void</span> <span class="nf">testWithCustomDisplayNames</span><span class="p">(</span><span class="n">String</span> <span class="n">fruit</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rank</span><span class="p">)</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>结果：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Display name of container ✔
├─ 1 ==&gt; the rank of &#39;apple&#39; is 1 ✔
├─ 2 ==&gt; the rank of &#39;banana&#39; is 2 ✔
└─ 3 ==&gt; the rank of &#39;lemon, lime&#39; is 3 ✔
</pre></div>
</div>
<blockquote>
<div><p>注意如果要显示<code class="docutils literal notranslate"><span class="pre">'apple'</span></code>，需要使用两层<code class="docutils literal notranslate"><span class="pre">''apple''</span></code>，因为name是MessageFormat。</p>
</div></blockquote>
<p>占位符说明如下：</p>
<p><img alt="image6" src="../_images/image-20210714155314425.png" /></p>
</div>
<div class="section" id="id9">
<h2>小结<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>本文介绍了JUnit5参数化测试的7种方式，分别是<code class="docutils literal notranslate"><span class="pre">&#64;ValueSource</span></code>，Null
and Empty
Sources，<code class="docutils literal notranslate"><span class="pre">&#64;EnumSource</span></code>，<code class="docutils literal notranslate"><span class="pre">&#64;MethodSource</span></code>，<code class="docutils literal notranslate"><span class="pre">&#64;CsvSource</span></code>，<code class="docutils literal notranslate"><span class="pre">&#64;CsvFileSource</span></code>，<code class="docutils literal notranslate"><span class="pre">&#64;ArgumentsSource</span></code>，比较偏向于Java语法，符合JUnit单元测试框架的特征。另外还介绍了JUnit
Jupiter的参数类型转换和参数聚合。最后，如果想要自定义参数化测试的名字，可以使用name属性实现。</p>
<blockquote>
<div><p>参考资料：</p>
<p><a class="reference external" href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests">https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests</a></p>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="007-JUnit5%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E4%B8%8E%E6%B5%8B%E8%AF%95%E6%8E%A5%E5%8F%A3.html" class="btn btn-neutral float-right" title="JUnit5依赖注入与测试接口" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="005-JUnit5%E7%9A%84%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95%E3%80%81%E5%B5%8C%E5%A5%97%E6%B5%8B%E8%AF%95%E3%80%81%E9%87%8D%E5%A4%8D%E6%B5%8B%E8%AF%95.html" class="btn btn-neutral float-left" title="JUnit5的条件测试、嵌套测试、重复测试" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 测试开发刚哥

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>