

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>单篇长文TestNG从入门到精通 &mdash; 测试开发刚哥 latest documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/js/readmore.js"></script>
        <script src="../_static/js/baidutongji.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="HttpRunner3源码剖析__init__文件干了些啥" href="301-HttpRunner3%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90__init__%E6%96%87%E4%BB%B6%E5%B9%B2%E4%BA%86%E4%BA%9B%E5%95%A5.html" />
    <link rel="prev" title="pytest用例查找原理" href="007-pytest%E7%94%A8%E4%BE%8B%E6%9F%A5%E6%89%BE%E5%8E%9F%E7%90%86.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> 测试开发刚哥
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tep.html">tep</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E4%BD%93%E7%B3%BB.html">测试体系</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E7%94%A8%E4%BE%8B%E8%AE%BE%E8%AE%A1.html">用例设计</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80.html">编程语言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95.html">接口测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E7%99%BD%E7%9B%92%E6%B5%8B%E8%AF%95.html">白盒测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95.html">单元测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E7%B2%BE%E5%87%86%E6%B5%8B%E8%AF%95.html">精准测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83.html">测试环境</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6.html">测试框架</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="001-pytest%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html">pytest快速入门</a></li>
<li class="toctree-l2"><a class="reference internal" href="002-pytest132%E4%B8%AA%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0%E7%94%A8%E6%B3%95.html">pytest132个命令行参数用法</a></li>
<li class="toctree-l2"><a class="reference internal" href="004-pytest%E5%86%85%E7%BD%AE%E5%92%8C%E8%87%AA%E5%AE%9A%E4%B9%89marker.html">pytest内置和自定义marker</a></li>
<li class="toctree-l2"><a class="reference internal" href="005-pytest%E5%8F%82%E6%95%B0%E5%8C%96%E8%BF%9B%E9%98%B6.html">pytest参数化进阶</a></li>
<li class="toctree-l2"><a class="reference internal" href="006-pytest%E6%96%AD%E8%A8%80%E6%8A%80%E5%B7%A7.html">pytest断言技巧</a></li>
<li class="toctree-l2"><a class="reference internal" href="007-pytest%E7%94%A8%E4%BE%8B%E6%9F%A5%E6%89%BE%E5%8E%9F%E7%90%86.html">pytest用例查找原理</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">单篇长文TestNG从入门到精通</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">简介</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">如何运行TestNG</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#idea">IDEA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#maven">Maven</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id3">测试方法和测试类</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">测试组</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">TestNG参数化</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#testng-xml">从testng.xml读取数据</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">通过代码读取数据</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id7">指定用例执行顺序</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">注解</a></li>
<li class="toctree-l4"><a class="reference internal" href="#xml">XML</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id9">动态创建测试用例</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">忽略部分测试用例</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">多线程并行测试用例</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">重跑失败用例</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">TestNG编程</a></li>
<li class="toctree-l3"><a class="reference internal" href="#xmlbeanshell">XML中写BeanShell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#listener">Listener</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">依赖注入</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">断言</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">日志</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">测试报告</a></li>
<li class="toctree-l3"><a class="reference internal" href="#yamlxml">YAML替代XML</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">彩蛋</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="301-HttpRunner3%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90__init__%E6%96%87%E4%BB%B6%E5%B9%B2%E4%BA%86%E4%BA%9B%E5%95%A5.html">HttpRunner3源码剖析__init__文件干了些啥</a></li>
<li class="toctree-l2"><a class="reference internal" href="302-HttpRunner3%E7%9A%84HTTP%E8%AF%B7%E6%B1%82%E6%98%AF%E6%80%8E%E4%B9%88%E5%8F%91%E5%87%BA%E5%8E%BB%E7%9A%84.html">HttpRunner3的HTTP请求是怎么发出去的</a></li>
<li class="toctree-l2"><a class="reference internal" href="303-HttpRunner3%E7%9A%84%E7%94%A8%E4%BE%8B%E6%98%AF%E6%80%8E%E4%B9%88%E8%BF%90%E8%A1%8C%E8%B5%B7%E6%9D%A5%E7%9A%84.html">HttpRunner3的用例是怎么运行起来的</a></li>
<li class="toctree-l2"><a class="reference internal" href="304-HttpRunner3%E7%9A%84%E5%8F%98%E9%87%8F%E6%98%AF%E5%A6%82%E4%BD%95%E4%BC%A0%E9%80%92%E7%9A%84.html">HttpRunner3的变量是如何传递的</a></li>
<li class="toctree-l2"><a class="reference internal" href="305-HttpRunner3%E7%9A%84%24%E7%AC%A6%E5%8F%B7%E6%98%AF%E5%A6%82%E4%BD%95%E8%A7%A3%E6%9E%90%E7%9A%84.html">HttpRunner3的$符号是如何解析的</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7.html">测试工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0.html">测试平台</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A.html">测试报告</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%81%E9%87%8F%E5%9B%9E%E6%94%BE.html">流量回放</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95.html">性能测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6.html">开发框架</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E4%B8%AD%E9%97%B4%E8%BD%AF%E4%BB%B6.html">中间软件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E9%80%9A%E7%94%A8%E6%8A%80%E6%9C%AF.html">通用技术</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E7%9F%A5%E8%AF%86%E8%83%BD%E5%8A%9B.html">知识能力</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html">读书笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E9%9D%A2%E8%AF%95%E5%A4%87%E6%88%98.html">面试备战</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%80%BB%E7%BB%93%E6%84%9F%E6%83%B3.html">总结感想</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E7%BD%91%E7%AB%99%E6%8E%A8%E8%8D%90.html">网站推荐</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E8%87%AA%E6%88%91%E4%BB%8B%E7%BB%8D.html">自我介绍</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">测试开发刚哥</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../chapters/%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6.html">测试框架</a> &raquo;</li>
        
      <li>单篇长文TestNG从入门到精通</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/测试框架/201-单篇长文TestNG从入门到精通.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="testng">
<h1>单篇长文TestNG从入门到精通<a class="headerlink" href="#testng" title="Permalink to this headline">¶</a></h1>
<p><img alt="image1" src="../_images/wanggang14.png" /></p>
<div class="section" id="id1">
<h2>简介<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>TestNG是Test Next
Generation的缩写，它的灵感来自于JUnit和NUnit，在它们基础上增加了很多很牛的功能，比如说：</p>
<ul class="simple">
<li><p>注解。</p></li>
<li><p>多线程，比如所有方法都在各自线程中，一个测试类一个线程等。</p></li>
<li><p>验证代码是否多线程安全。</p></li>
<li><p>灵活的测试配置。</p></li>
<li><p>支持数据驱动（&#64;DataProvider）。</p></li>
<li><p>支持参数化。</p></li>
<li><p>强大的执行机制（不需要TestSuite）。</p></li>
<li><p>能跟各种工具结合（比如IDEA、Maven等）。</p></li>
<li><p>内嵌BeanShell。</p></li>
<li><p>提供运行时和日志的JDK函数（不需要添加dependencies）。</p></li>
<li><p>提供应用服务器测试依赖的方法。</p></li>
</ul>
<p>一句话总结就是，<strong>TestNG强大到能覆盖所有测试类型：单元测试、功能测试、端到端测试、集成测试</strong>等等等。</p>
<p>一个简单的示例如下：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">example1</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.testng.annotations.*</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleTest</span> <span class="p">{</span>

 <span class="nd">@BeforeClass</span>
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>
   <span class="c1">// code that will be invoked when this test is instantiated</span>
 <span class="p">}</span>

 <span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;fast&quot;</span> <span class="p">})</span>
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">aFastTest</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Fast test&quot;</span><span class="p">);</span>
 <span class="p">}</span>

 <span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;slow&quot;</span> <span class="p">})</span>
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">aSlowTest</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Slow test&quot;</span><span class="p">);</span>
 <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>setUp()会在<strong>测试类创建后，测试方法执行前</strong>运行。</p></li>
<li><p>测试方法名字可以任意的，TestNG通过&#64;Test注解来标识。</p></li>
<li><p>可以把测试方法按group分组。</p></li>
</ul>
<p>然后使用xml来配置运行策略：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;project</span> <span class="na">default=</span><span class="s">&quot;test&quot;</span><span class="nt">&gt;</span>

 <span class="nt">&lt;path</span> <span class="na">id=</span><span class="s">&quot;cp&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;pathelement</span> <span class="na">location=</span><span class="s">&quot;lib/testng-testng-5.13.1.jar&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;pathelement</span> <span class="na">location=</span><span class="s">&quot;build&quot;</span><span class="nt">/&gt;</span>
 <span class="nt">&lt;/path&gt;</span>

 <span class="nt">&lt;taskdef</span> <span class="na">name=</span><span class="s">&quot;testng&quot;</span> <span class="na">classpathref=</span><span class="s">&quot;cp&quot;</span>
          <span class="na">classname=</span><span class="s">&quot;org.testng.TestNGAntTask&quot;</span> <span class="nt">/&gt;</span>

 <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;test&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;testng</span> <span class="na">classpathref=</span><span class="s">&quot;cp&quot;</span> <span class="na">groups=</span><span class="s">&quot;fast&quot;</span><span class="nt">&gt;</span>
     <span class="nt">&lt;classfileset</span> <span class="na">dir=</span><span class="s">&quot;build&quot;</span> <span class="na">includes=</span><span class="s">&quot;example1/*.class&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/testng&gt;</span>
 <span class="nt">&lt;/target&gt;</span>

<span class="nt">&lt;/project&gt;</span>
</pre></div>
</div>
<p>使用ant调用（<strong>下面第2节给出了最新的运行方式</strong>）：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="p">:</span><span class="o">&gt;</span> <span class="n">ant</span>
<span class="n">Buildfile</span><span class="p">:</span> <span class="n">build</span><span class="o">.</span><span class="n">xml</span>

<span class="n">test</span><span class="p">:</span>
<span class="p">[</span><span class="n">testng</span><span class="p">]</span> <span class="n">Fast</span> <span class="n">test</span>
<span class="p">[</span><span class="n">testng</span><span class="p">]</span> <span class="o">===============================================</span>
<span class="p">[</span><span class="n">testng</span><span class="p">]</span> <span class="n">Suite</span> <span class="k">for</span> <span class="n">Command</span> <span class="n">line</span> <span class="n">test</span>
<span class="p">[</span><span class="n">testng</span><span class="p">]</span> <span class="n">Total</span> <span class="n">tests</span> <span class="n">run</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Failures</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Skips</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">[</span><span class="n">testng</span><span class="p">]</span> <span class="o">===============================================</span>


<span class="n">BUILD</span> <span class="n">SUCCESSFUL</span>
<span class="n">Total</span> <span class="n">time</span><span class="p">:</span> <span class="mi">4</span> <span class="n">seconds</span>
</pre></div>
</div>
<p>最后就能看报告了：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">test</span><span class="o">-</span><span class="n">output</span>\<span class="n">index</span><span class="o">.</span><span class="n">html</span> <span class="p">(</span><span class="n">on</span> <span class="n">Windows</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h2>如何运行TestNG<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>除了前面提到的ant调用，更常见的运行TestNG的方式是以下两种：</p>
<ol class="arabic simple">
<li><p>IDEA</p></li>
<li><p>Maven</p></li>
</ol>
<div class="section" id="idea">
<h3>IDEA<a class="headerlink" href="#idea" title="Permalink to this headline">¶</a></h3>
<p>在IDEA中运行TestNG第①种方式是点击方法或类前面的小箭头：</p>
<p><img alt="image2" src="../_images/image-20211230205637704.png" /></p>
<p>第②种方式是在方法或类内部点击右键：</p>
<p><img alt="image3" src="../_images/image-20211230205734837.png" /></p>
<p><img alt="image4" src="../_images/image-20211230205752151.png" /></p>
<p>第③种方式是使用testng.xml，IDEA可以右键testng.xml来运行，在文件名和文件内部点击均可：</p>
<p><img alt="image5" src="../_images/image-20211230212649756.png" /></p>
<p>testng.xml支持很多种配置，比如配置测试类：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE suite SYSTEM &quot;https://testng.org/testng-1.0.dtd&quot; &gt;</span>

<span class="nt">&lt;suite</span> <span class="na">name=</span><span class="s">&quot;Suite1&quot;</span> <span class="na">verbose=</span><span class="s">&quot;1&quot;</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;Nopackage&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;classes&gt;</span>
       <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;NoPackageTest&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/classes&gt;</span>
  <span class="nt">&lt;/test&gt;</span>

  <span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;Regression1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;classes&gt;</span>
      <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;test.sample.ParameterSample&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;test.sample.ParameterTest&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/classes&gt;</span>
  <span class="nt">&lt;/test&gt;</span>
<span class="nt">&lt;/suite&gt;</span>
</pre></div>
</div>
<p>配置测试包：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE suite SYSTEM &quot;https://testng.org/testng-1.0.dtd&quot; &gt;</span>

<span class="nt">&lt;suite</span> <span class="na">name=</span><span class="s">&quot;Suite1&quot;</span> <span class="na">verbose=</span><span class="s">&quot;1&quot;</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;Regression1&quot;</span>   <span class="nt">&gt;</span>
    <span class="nt">&lt;packages&gt;</span>
      <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&quot;test.sample&quot;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;/packages&gt;</span>
 <span class="nt">&lt;/test&gt;</span>
<span class="nt">&lt;/suite&gt;</span>
</pre></div>
</div>
<p>配置组和方法：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE suite SYSTEM &quot;https://testng.org/testng-1.0.dtd&quot; &gt;</span>

<span class="nt">&lt;suite</span> <span class="na">name=</span><span class="s">&quot;Suite1&quot;</span> <span class="na">verbose=</span><span class="s">&quot;1&quot;</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;Regression1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;groups&gt;</span>
      <span class="nt">&lt;run&gt;</span>
        <span class="nt">&lt;exclude</span> <span class="na">name=</span><span class="s">&quot;brokenTests&quot;</span>  <span class="nt">/&gt;</span>
        <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;checkinTests&quot;</span>  <span class="nt">/&gt;</span>
      <span class="nt">&lt;/run&gt;</span>
    <span class="nt">&lt;/groups&gt;</span>

    <span class="nt">&lt;classes&gt;</span>
      <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;test.IndividualMethodsTest&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;methods&gt;</span>
          <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;testMethod&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/methods&gt;</span>
      <span class="nt">&lt;/class&gt;</span>
    <span class="nt">&lt;/classes&gt;</span>
  <span class="nt">&lt;/test&gt;</span>
<span class="nt">&lt;/suite&gt;</span>
</pre></div>
</div>
<p>默认TestNG会按xml顺序执行，可以设置
<code class="docutils literal notranslate"><span class="pre">preserve-order</span></code>为false变成随机顺序：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE suite SYSTEM &quot;https://testng.org/testng-1.0.dtd&quot; &gt;</span>

<span class="nt">&lt;suite</span> <span class="na">name=</span><span class="s">&quot;Suite1&quot;</span> <span class="na">verbose=</span><span class="s">&quot;1&quot;</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;Regression1&quot;</span> <span class="na">preserve-order=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;classes&gt;</span>

      <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;test.Test1&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;methods&gt;</span>
          <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;m1&quot;</span> <span class="nt">/&gt;</span>
          <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;m2&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/methods&gt;</span>
      <span class="nt">&lt;/class&gt;</span>

      <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;test.Test2&quot;</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;/classes&gt;</span>
  <span class="nt">&lt;/test&gt;</span>
<span class="nt">&lt;/suite&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="maven">
<h3>Maven<a class="headerlink" href="#maven" title="Permalink to this headline">¶</a></h3>
<p>官方教程给出了命令行执行TestNG：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">java</span> <span class="n">org</span><span class="o">.</span><span class="n">testng</span><span class="o">.</span><span class="n">TestNG</span> <span class="n">testng1</span><span class="o">.</span><span class="n">xml</span> <span class="p">[</span><span class="n">testng2</span><span class="o">.</span><span class="n">xml</span> <span class="n">testng3</span><span class="o">.</span><span class="n">xml</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>实际调用是调不通的，可以借助Maven来实现</strong>。</p>
<p>先在pom.xml添加：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.19.1<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
                <span class="nt">&lt;suiteXmlFiles&gt;</span>
                    <span class="nt">&lt;suiteXmlFile&gt;</span>testng.xml<span class="nt">&lt;/suiteXmlFile&gt;</span>
                <span class="nt">&lt;/suiteXmlFiles&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
<span class="nt">&lt;/build&gt;</span>
</pre></div>
</div>
<p>然后执行<code class="docutils literal notranslate"><span class="pre">mvn</span> <span class="pre">clean</span> <span class="pre">test</span></code>命令就行啦。</p>
</div>
</div>
<div class="section" id="id3">
<h2>测试方法和测试类<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>使用了&#64;Test注解的方法就是测试方法，包含测试方法的类就是测试类。比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">example1</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.testng.annotations.*</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleTest</span> <span class="p">{</span>

 <span class="nd">@BeforeClass</span>
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>
   <span class="c1">// code that will be invoked when this test is instantiated</span>
 <span class="p">}</span>

 <span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;fast&quot;</span> <span class="p">})</span>
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">aFastTest</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Fast test&quot;</span><span class="p">);</span>
 <span class="p">}</span>

 <span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;slow&quot;</span> <span class="p">})</span>
 <span class="kd">public</span> <span class="kt">void</span> <span class="nf">aSlowTest</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Slow test&quot;</span><span class="p">);</span>
 <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>&#64;Test也能放在测试类上面，这样测试类下的所有方法都是测试方法，比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test1</span> <span class="p">{</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test1</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test2</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>而且可以在测试类和测试方法上同时使用&#64;Test，比如给某个Test加入分组：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test1</span> <span class="p">{</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test1</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="s">&quot;g1&quot;</span><span class="p">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test2</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>有个点需要注意的是&#64;Test注解的测试方法，默认是会忽略返回值的，除非在testng.xml配置：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;suite</span> <span class="na">allow-return-values=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>

or

<span class="nt">&lt;test</span> <span class="na">allow-return-values=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h2>测试组<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>测试组其实就是给测试方法打标记，比如冒烟测试用例和功能测试用例：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test1</span> <span class="p">{</span>
  <span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;functest&quot;</span><span class="p">,</span> <span class="s">&quot;checkintest&quot;</span> <span class="p">})</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testMethod1</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;functest&quot;</span><span class="p">,</span> <span class="s">&quot;checkintest&quot;</span><span class="p">}</span> <span class="p">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testMethod2</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;functest&quot;</span> <span class="p">})</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testMethod3</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>如果只配置functest，就会执行全部测试方法：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;Test1&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;groups&gt;</span>
    <span class="nt">&lt;run&gt;</span>
      <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;functest&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/run&gt;</span>
  <span class="nt">&lt;/groups&gt;</span>
  <span class="nt">&lt;classes&gt;</span>
    <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;example1.Test1&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/classes&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<p>如果只配置checkintest，就会只执行前面2个方法：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;Test1&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;groups&gt;</span>
    <span class="nt">&lt;run&gt;</span>
      <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;checkintest&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/run&gt;</span>
  <span class="nt">&lt;/groups&gt;</span>
  <span class="nt">&lt;classes&gt;</span>
    <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;example1.Test1&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/classes&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<p>除了指定完整name，也可以使用正则表达式：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test1</span> <span class="p">{</span>
  <span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;windows.checkintest&quot;</span> <span class="p">})</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testWindowsOnly</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;linux.checkintest&quot;</span><span class="p">}</span> <span class="p">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testLinuxOnly</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;windows.functest&quot;</span> <span class="p">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testWindowsToo</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;Test1&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;groups&gt;</span>
    <span class="nt">&lt;run&gt;</span>
      <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;windows.*&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/run&gt;</span>
  <span class="nt">&lt;/groups&gt;</span>

  <span class="nt">&lt;classes&gt;</span>
    <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;example1.Test1&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/classes&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<p>进一步，测试组除了include测试方法，还可以exclude：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;Test1&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;classes&gt;</span>
    <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;example1.Test1&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;methods&gt;</span>
        <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;.*enabledTestMethod.*&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;exclude</span> <span class="na">name=</span><span class="s">&quot;.*brokenTestMethod.*&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/methods&gt;</span>
     <span class="nt">&lt;/class&gt;</span>
  <span class="nt">&lt;/classes&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<blockquote>
<div><p>还有一个办法是使用<em>&#64;Test</em>和<em>&#64;Before/After</em>的<code class="docutils literal notranslate"><span class="pre">enabled</span></code>属性。</p>
</div></blockquote>
<p>测试组也能进行嵌套：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;Regression1&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;groups&gt;</span>
    <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;functest&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;windows&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;linux&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/define&gt;</span>

    <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;all&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;functest&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;checkintest&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/define&gt;</span>

    <span class="nt">&lt;run&gt;</span>
      <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;all&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/run&gt;</span>
  <span class="nt">&lt;/groups&gt;</span>

  <span class="nt">&lt;classes&gt;</span>
    <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;test.sample.Test1&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/classes&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&lt;define&gt;&lt;/define&gt;</span></code>定义了父分组，里面<code class="docutils literal notranslate"><span class="pre">&lt;include&gt;</span></code>的就是子分组。</p>
<p>同样的，嵌套分组也可以对子分组进行exclude：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;checkintest&quot;</span><span class="p">,</span> <span class="s">&quot;broken&quot;</span><span class="p">}</span> <span class="p">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testMethod2</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">test</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;Simple example&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">groups</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">run</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">include</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;checkintest&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="n">exclude</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;broken&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;/</span><span class="n">run</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">groups</span><span class="o">&gt;</span>

  <span class="o">&lt;</span><span class="n">classes</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="kd">class</span> <span class="nc">name</span><span class="o">=</span><span class="s">&quot;example1.Test1&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;/</span><span class="n">classes</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">test</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>最后，对于分组的位置，如果测试类和测试方法都标记了分组，那么测试类的分组会作用到所有方法中，比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;checkin-test&quot;</span><span class="p">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">All</span> <span class="p">{</span>
    <span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;func-test&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">method1</span><span class="p">()</span> <span class="p">{</span> <span class="p">...}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">method2</span><span class="p">()</span> <span class="p">{</span> <span class="p">...}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>method2()属于checkin-test分组，method1属于func-test和checkin-test两个分组。</p>
</div>
<div class="section" id="id5">
<h2>TestNG参数化<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>TestNG参数化有两种方式，第一种是从testng.xml读取数据，第二种是通过代码读取数据。</p>
<div class="section" id="testng-xml">
<h3>从testng.xml读取数据<a class="headerlink" href="#testng-xml" title="Permalink to this headline">¶</a></h3>
<p>直接看示例：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Parameters</span><span class="p">({</span> <span class="s">&quot;first-name&quot;</span> <span class="p">})</span>
<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testSingleString</span><span class="p">(</span><span class="n">String</span> <span class="n">firstName</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Invoked testString &quot;</span> <span class="o">+</span> <span class="n">firstName</span><span class="p">);</span>
  <span class="k">assert</span> <span class="s">&quot;Cedric&quot;</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">firstName</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">suite</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;My suite&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;first-name&quot;</span>  <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Cedric&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="n">test</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Simple example&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;--</span> <span class="o">...</span> <span class="o">--&gt;</span>
</pre></div>
</div>
<ul>
<li><p>&#64;Parameters指定参数化名字。</p></li>
<li><p>测试方法入参与参数化名字一一对应。</p></li>
<li><p>testng.xml中<code class="docutils literal notranslate"><span class="pre">&lt;parameter&gt;</span></code>定义参数化的值。</p>
<blockquote>
<div><p>在testng.xml中，<code class="docutils literal notranslate"><span class="pre">&lt;parameter&gt;</span></code>既可以定义在<code class="docutils literal notranslate"><span class="pre">&lt;suite&gt;</span></code>中也可以定义在<code class="docutils literal notranslate"><span class="pre">&lt;test&gt;</span></code>中，如果有同名的，会以<code class="docutils literal notranslate"><span class="pre">&lt;test&gt;</span></code>的覆盖<code class="docutils literal notranslate"><span class="pre">&lt;suite&gt;</span></code>。</p>
</div></blockquote>
</li>
</ul>
<p>&#64;Parameters既可以作用到<code class="docutils literal notranslate"><span class="pre">&#64;Test</span></code>，也可以作用到
<code class="docutils literal notranslate"><span class="pre">&#64;Before/After</span></code>和<code class="docutils literal notranslate"><span class="pre">&#64;Factory</span></code>，比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Parameters</span><span class="p">({</span> <span class="s">&quot;datasource&quot;</span><span class="p">,</span> <span class="s">&quot;jdbcDriver&quot;</span> <span class="p">})</span>
<span class="nd">@BeforeMethod</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeTest</span><span class="p">(</span><span class="n">String</span> <span class="n">ds</span><span class="p">,</span> <span class="n">String</span> <span class="n">driver</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">m_dataSource</span> <span class="o">=</span> <span class="p">...;</span>                              <span class="c1">// look up the value of datasource</span>
  <span class="n">m_jdbcDriver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<blockquote>
<div><p>也可以作用到测试类的构造方法中，但是只能最多一个构造方法，这样就能在初始化类的时候，进行参数化赋值，便于测试方法使用</p>
</div></blockquote>
<p>&#64;Optional用于标识参数是否可选，比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Parameters</span><span class="p">(</span><span class="s">&quot;db&quot;</span><span class="p">)</span>
<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testNonExistentParameter</span><span class="p">(</span><span class="nd">@Optional</span><span class="p">(</span><span class="s">&quot;mysql&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">db</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>如果db这个参数取不到名字，那么就会取mysql的值。</p></li>
</ul>
</div>
<div class="section" id="id6">
<h3>通过代码读取数据<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>第一种参数化方式其实比较鸡肋，第二种方式才是TestNG参数化的灵魂，用到了<strong>&#64;DataProvider</strong>，它会返回一个二维数组：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.testng.annotations.DataProvider</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.testng.annotations.Test</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DPTest</span> <span class="p">{</span>
    <span class="nd">@DataProvider</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;test1&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Object</span><span class="o">[][]</span> <span class="nf">createData1</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[][]</span> <span class="p">{</span>
                <span class="p">{</span> <span class="s">&quot;Cedric&quot;</span><span class="p">,</span> <span class="mi">36</span><span class="p">},</span>
                <span class="p">{</span> <span class="s">&quot;Anne&quot;</span><span class="p">,</span> <span class="mi">37</span><span class="p">},</span>
        <span class="p">};</span>
    <span class="p">}</span>

    <span class="nd">@Test</span><span class="p">(</span><span class="n">dataProvider</span> <span class="o">=</span> <span class="s">&quot;test1&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">verifyData1</span><span class="p">(</span><span class="n">String</span> <span class="n">n1</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">n2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">n2</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>&#64;DataProvider用于生产数据，name是唯一标识。</p></li>
<li><p>在&#64;Test中通过dataProvider属性指定name。</p></li>
<li><p>测试方法的入参跟数组中元素一一对应。</p></li>
</ul>
<p>默认&#64;DataProvider和&#64;Test是在同一个类中，如果想放在不同的类，那么需要定义为静态方法（或者无参数构造方法的类），比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.testng.annotations.DataProvider</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">StaticProvider</span> <span class="p">{</span>
    <span class="nd">@DataProvider</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Object</span><span class="o">[][]</span> <span class="nf">createData</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[][]</span> <span class="p">{</span>
                <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="p">{</span><span class="mi">42</span><span class="p">}</span>
        <span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.testng.annotations.Test</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DiffClazzTest</span> <span class="p">{</span>
    <span class="nd">@Test</span><span class="p">(</span><span class="n">dataProvider</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">dataProviderClass</span> <span class="o">=</span> <span class="n">StaticProvider</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="p">(</span><span class="n">Integer</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>createData()为static。</p></li>
<li><p>需要额外通过&#64;Test的dataProviderClass属性指定&#64;DataProvider所在的类。</p></li>
</ul>
<p>&#64;DataProvider的返回值（<strong>参数类型</strong>）除了已经提到的<code class="docutils literal notranslate"><span class="pre">Object[][]</span></code>，还可以是<code class="docutils literal notranslate"><span class="pre">Iterator&lt;Object[]&gt;</span></code>，它不会一次性生成所有数据，而是每调用一次生成一次，节约内存，比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.testng.annotations.DataProvider</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.testng.annotations.Test</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IterTest</span> <span class="p">{</span>
    <span class="nd">@DataProvider</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;test1&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="nf">createData1</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">Object</span><span class="o">[][]</span> <span class="n">myObjects</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[][]</span><span class="p">{</span>
                <span class="p">{</span><span class="s">&quot;Cedric&quot;</span><span class="p">,</span> <span class="mi">36</span><span class="p">},</span>
                <span class="p">{</span><span class="s">&quot;Anne&quot;</span><span class="p">,</span> <span class="mi">37</span><span class="p">},</span>
        <span class="p">};</span>
        <span class="k">return</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">myObjects</span><span class="p">).</span><span class="na">iterator</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Test</span><span class="p">(</span><span class="n">dataProvider</span> <span class="o">=</span> <span class="s">&quot;test1&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">verifyData1</span><span class="p">(</span><span class="n">String</span> <span class="n">n1</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">n2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">n2</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>看到这里，对&#64;DataProvider已经有了足够的认识，它支持两种参数类型</strong>：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Object[][]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Iterator&lt;Object[]&gt;</span></code></p></li>
</ul>
<p>假如测试方法只有一个入参，是不是只能用二维来实现：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.testng.annotations.DataProvider</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.testng.annotations.Test</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IterTest</span> <span class="p">{</span>
    <span class="nd">@DataProvider</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;test1&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="nf">createData1</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">Object</span><span class="o">[][]</span> <span class="n">myObjects</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[][]</span><span class="p">{{</span><span class="s">&quot;x&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s">&quot;y&quot;</span><span class="p">}};</span>
        <span class="k">return</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">myObjects</span><span class="p">).</span><span class="na">iterator</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Test</span><span class="p">(</span><span class="n">dataProvider</span> <span class="o">=</span> <span class="s">&quot;test1&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">verifyData1</span><span class="p">(</span><span class="n">String</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>其实不是，<strong>&#64;DataProvider支持一维</strong>数组：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.testng.annotations.DataProvider</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.testng.annotations.Test</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IterTest</span> <span class="p">{</span>
    <span class="nd">@DataProvider</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;test1&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Object</span><span class="o">[]</span> <span class="nf">createData1</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">Object</span><span class="o">[]</span> <span class="n">myObjects</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span><span class="p">{</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">};</span>
        <span class="k">return</span> <span class="n">myObjects</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Test</span><span class="p">(</span><span class="n">dataProvider</span> <span class="o">=</span> <span class="s">&quot;test1&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">verifyData1</span><span class="p">(</span><span class="n">String</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>以及一维数组的迭代器：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.testng.annotations.DataProvider</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.testng.annotations.Test</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IterTest</span> <span class="p">{</span>
    <span class="nd">@DataProvider</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;test1&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">createData1</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">Object</span><span class="o">[]</span> <span class="n">myObjects</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span><span class="p">{</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">};</span>
        <span class="k">return</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">myObjects</span><span class="p">).</span><span class="na">iterator</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Test</span><span class="p">(</span><span class="n">dataProvider</span> <span class="o">=</span> <span class="s">&quot;test1&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">verifyData1</span><span class="p">(</span><span class="n">String</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>最精彩的来了，&#64;DataProvider支持反射，也就是反向获取测试方法的信息：</strong></p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@DataProvider</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;dp&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="n">Object</span><span class="o">[][]</span> <span class="nf">createData</span><span class="p">(</span><span class="n">Method</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span>  <span class="c1">// print test method name</span>
  <span class="k">return</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[][]</span> <span class="p">{</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="p">{</span> <span class="s">&quot;Cedric&quot;</span> <span class="p">}};</span>
<span class="p">}</span>

<span class="nd">@Test</span><span class="p">(</span><span class="n">dataProvider</span> <span class="o">=</span> <span class="s">&quot;dp&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test1</span><span class="p">(</span><span class="n">String</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
<span class="p">}</span>

<span class="nd">@Test</span><span class="p">(</span><span class="n">dataProvider</span> <span class="o">=</span> <span class="s">&quot;dp&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test2</span><span class="p">(</span><span class="n">String</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>createData的入参是java.lang.reflect.Method，这样就能获取到测试方法的信息，比如这里的getName()会依次拿到test1、test2。</p></li>
</ul>
<p>&#64;DataProvider还支持并发：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@DataProvider</span><span class="p">(</span><span class="n">parallel</span> <span class="o">=</span> <span class="kc">true</span><span class="p">)</span><span class="c1">// ...</span>
</pre></div>
</div>
<p>默认是10个线程，可以在testng.xml中修改：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">suite</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Suite1&quot;</span> <span class="n">data</span><span class="o">-</span><span class="n">provider</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="n">count</span><span class="o">=</span><span class="s2">&quot;20&quot;</span> <span class="o">&gt;...</span>
</pre></div>
</div>
<p>一个xml共享一个线程池，如果要用多个线程池，那么需要创建多个testng.xml。</p>
<p>锦上添花的是，TestNG的参数化会打印在测试报告中：</p>
<p><img alt="image6" src="../_images/parameters.png" /></p>
</div>
</div>
<div class="section" id="id7">
<h2>指定用例执行顺序<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>TestNG用例的执行顺序有两种方式来指定：注解和XML。</p>
<div class="section" id="id8">
<h3>注解<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>使用&#64;Test的dependsOnMethods属性：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">serverStartedOk</span><span class="p">()</span> <span class="p">{}</span>

<span class="nd">@Test</span><span class="p">(</span><span class="n">dependsOnMethods</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;serverStartedOk&quot;</span> <span class="p">})</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">method1</span><span class="p">()</span> <span class="p">{}</span>
</pre></div>
</div>
<p>或者dependsOnGroups属性：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;init&quot;</span> <span class="p">})</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">serverStartedOk</span><span class="p">()</span> <span class="p">{}</span>

<span class="nd">@Test</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;init&quot;</span> <span class="p">})</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initEnvironment</span><span class="p">()</span> <span class="p">{}</span>

<span class="nd">@Test</span><span class="p">(</span><span class="n">dependsOnGroups</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;init.*&quot;</span> <span class="p">})</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">method1</span><span class="p">()</span> <span class="p">{}</span>
</pre></div>
</div>
<blockquote>
<div><p>&#64;Before/After也能实现初始化，但是它们的结果不会出现在测试报告中。</p>
</div></blockquote>
<p>默认TestNG会强制校验，依赖的用例必须成功才会执行当前用例，否则当前用例会被标记为SKIP，这叫做<strong>强依赖</strong>。通过设置alwaysRun=true可以变成<strong>弱依赖</strong>，无论依赖用例执行成功与否，都会执行当前用例。</p>
<p>需要特别注意的是，依赖测试方法是按照测试类来进行执行的（group by
class），比如b()方法依赖的a()方法有多个实例，那么会按照以下顺序执行:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">b</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">b</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>举个实际的例子，登入和登出，如果想达到以下效果：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">signIn</span><span class="p">(</span><span class="s2">&quot;us&quot;</span><span class="p">)</span>
<span class="n">signOut</span><span class="p">(</span><span class="s2">&quot;us&quot;</span><span class="p">)</span>
<span class="n">signIn</span><span class="p">(</span><span class="s2">&quot;uk&quot;</span><span class="p">)</span>
<span class="n">signOut</span><span class="p">(</span><span class="s2">&quot;uk&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>那么需要在XML中进行配置：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">suite</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Factory&quot;</span> <span class="n">group</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">instances</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="o">&gt;</span>
<span class="ow">or</span>
  <span class="o">&lt;</span><span class="n">test</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Factory&quot;</span> <span class="n">group</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">instances</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="xml">
<h3>XML<a class="headerlink" href="#xml" title="Permalink to this headline">¶</a></h3>
<p>在testng.xml中使用<code class="docutils literal notranslate"><span class="pre">&lt;dependencies&gt;</span></code>和<code class="docutils literal notranslate"><span class="pre">depends-on</span></code>来指定用例顺序：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;My suite&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;groups&gt;</span>
    <span class="nt">&lt;dependencies&gt;</span>
      <span class="nt">&lt;group</span> <span class="na">name=</span><span class="s">&quot;c&quot;</span> <span class="na">depends-on=</span><span class="s">&quot;a  b&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;group</span> <span class="na">name=</span><span class="s">&quot;z&quot;</span> <span class="na">depends-on=</span><span class="s">&quot;c&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
  <span class="nt">&lt;/groups&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id9">
<h2>动态创建测试用例<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>假设有这样的测试用例，在测试时需要对网页访问多次，那么在TestNG中会这样编写代码：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestWebServer</span> <span class="p">{</span>
  <span class="nd">@Test</span><span class="p">(</span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;number-of-times&quot;</span> <span class="p">})</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accessPage</span><span class="p">(</span><span class="kt">int</span> <span class="n">numberOfTimes</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">numberOfTimes</span><span class="o">--</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
     <span class="c1">// access the web page</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;T1&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;parameter</span> <span class="na">name=</span><span class="s">&quot;number-of-times&quot;</span> <span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;classes&gt;</span>
    <span class="nt">&lt;class</span> <span class="na">name=</span> <span class="s">&quot;TestWebServer&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/classes&gt;</span>
<span class="nt">&lt;/test&gt;</span>

<span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;T2&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;parameter</span> <span class="na">name=</span><span class="s">&quot;number-of-times&quot;</span> <span class="na">value=</span><span class="s">&quot;20&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;classes&gt;</span>
    <span class="nt">&lt;class</span> <span class="na">name=</span> <span class="s">&quot;TestWebServer&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/classes&gt;</span>
<span class="nt">&lt;/test&gt;</span>

<span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;T3&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;parameter</span> <span class="na">name=</span><span class="s">&quot;number-of-times&quot;</span> <span class="na">value=</span><span class="s">&quot;30&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;classes&gt;</span>
    <span class="nt">&lt;class</span> <span class="na">name=</span> <span class="s">&quot;TestWebServer&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/classes&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>由于访问次数不一，在testng.xml中定义了3个test，然后借助参数化将访问次数传给&#64;Test测试方法。</p></li>
<li><p>在&#64;Test测试方法中循环遍历numberOfTimes。</p></li>
</ul>
<p>这种需求可以采用TestNG的Factory来对代码进行简化：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.testng.annotations.Factory</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebTestFactory</span> <span class="p">{</span>
    <span class="nd">@Factory</span>
    <span class="kd">public</span> <span class="n">Object</span><span class="o">[]</span> <span class="nf">createInstances</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">Object</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">result</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">WebTest</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.testng.annotations.Test</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebTest</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">m_numberOfTimes</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">WebTest</span><span class="p">(</span><span class="kt">int</span> <span class="n">numberOfTimes</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m_numberOfTimes</span> <span class="o">=</span> <span class="n">numberOfTimes</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testServer</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m_numberOfTimes</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// access the web page</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>WebTestFactory是工厂函数，返回Object[]。</p></li>
<li><p>WebTestFactory动态创建了多个WebTest实例。</p></li>
</ul>
<p>既可以在IDEA中点击WebTestFactory的运行按钮执行测试：</p>
<p><img alt="image7" src="../_images/image-20220111093212591.png" /></p>
<blockquote>
<div><p>注意如果执行WebTest，会提示No tests were found。</p>
</div></blockquote>
<p>也可以在testng.xml中驱动：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;WebTestFactory&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>还可以直接在代码中驱动：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">TestNG</span> <span class="n">testNG</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TestNG</span><span class="p">();</span>
<span class="n">testNG</span><span class="p">.</span><span class="na">setTestClasses</span><span class="p">(</span><span class="n">WebTestFactory</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="n">testNG</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>
</pre></div>
</div>
<p>&#64;Factory和&#64;Test一样，都能使用dataProvider属性，比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Factory</span><span class="p">(</span><span class="n">dataProvider</span> <span class="o">=</span> <span class="s">&quot;dp&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="nf">FactoryDataProviderSampleTest</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">super</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="p">}</span>

<span class="nd">@DataProvider</span>
<span class="kd">static</span> <span class="kd">public</span> <span class="n">Object</span><span class="o">[][]</span> <span class="nf">dp</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[][]</span> <span class="p">{</span>
    <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="p">{</span> <span class="mi">41</span> <span class="p">},</span>
    <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="p">{</span> <span class="mi">42</span> <span class="p">},</span>
  <span class="p">};</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h2>忽略部分测试用例<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p>TestNG可以使用&#64;Ignore注解忽略测试，比如：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.testng.annotations.Ignore</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.testng.annotations.Test</span><span class="p">;</span>

<span class="nd">@Ignore</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestcaseSample</span> <span class="p">{</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testMethod1</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testMethod2</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>如果作用到测试类上，那么它会忽略这个类下面的所有测试方法。如果只作用到测试方法上，那么它就相当于&#64;Test(enabled=false)。另外还能放在包上面：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Ignore</span>
<span class="kn">package</span> <span class="nn">com.testng.master</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.testng.annotations.Ignore</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h2>多线程并行测试用例<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<p>可以给&#64;Test添加属性，让用例以多线程并行执行：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Test</span><span class="p">(</span><span class="n">threadPoolSize</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">invocationCount</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>  <span class="n">timeOut</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testServer</span><span class="p">()</span> <span class="p">{</span>
</pre></div>
</div>
<ul class="simple">
<li><p>threadPoolSize指3个线程。</p></li>
<li><p>invocationCount指运行10次。</p></li>
<li><p>timeOut指阻塞等待超时。</p></li>
</ul>
<p>也可以在testng.xml中设置，thread-count指定线程数，parallel设置不同的值有不同的含义：</p>
<p>methods：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;suite</span> <span class="na">name=</span><span class="s">&quot;My suite&quot;</span> <span class="na">parallel=</span><span class="s">&quot;methods&quot;</span> <span class="na">thread-count=</span><span class="s">&quot;5&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>所有测试方法在不同的独立线程中执行。</p>
<p>tests：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;suite</span> <span class="na">name=</span><span class="s">&quot;My suite&quot;</span> <span class="na">parallel=</span><span class="s">&quot;tests&quot;</span> <span class="na">thread-count=</span><span class="s">&quot;5&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&lt;test&gt;</span></code>标签内的测试方法会在同一个线程中执行，不同的<code class="docutils literal notranslate"><span class="pre">&lt;test&gt;</span></code>标签会在不同的独立线程中执行。</p>
<p>classes：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;suite</span> <span class="na">name=</span><span class="s">&quot;My suite&quot;</span> <span class="na">parallel=</span><span class="s">&quot;classes&quot;</span> <span class="na">thread-count=</span><span class="s">&quot;5&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>同一个类中的测试方法会在同一个线程中执行，不同的类会在不同的独立线程中执行。</p>
<p>instances：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;suite</span> <span class="na">name=</span><span class="s">&quot;My suite&quot;</span> <span class="na">parallel=</span><span class="s">&quot;instances&quot;</span> <span class="na">thread-count=</span><span class="s">&quot;5&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>同一个实例中的测试方法会在同一个线程中执行，不同的实例会在不同的独立线程中执行。（Factory能创建多个实例）</p>
</div>
<div class="section" id="id12">
<h2>重跑失败用例<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<p>TestNG在运行后会把失败的用例输出到<code class="docutils literal notranslate"><span class="pre">testng-failed.xml</span></code>文件中，可以直接运行这个文件来重跑失败用例。</p>
<blockquote>
<div><p>夸一句，这个设计真棒。</p>
</div></blockquote>
<p>有时候，需要让用例失败时自动重试，那么可以在代码中这样实现：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.testng.IRetryAnalyzer</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.testng.ITestResult</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyRetry</span> <span class="kd">implements</span> <span class="n">IRetryAnalyzer</span> <span class="p">{</span>

  <span class="kd">private</span> <span class="kt">int</span> <span class="n">retryCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">maxRetryCount</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">retry</span><span class="p">(</span><span class="n">ITestResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">retryCount</span> <span class="o">&lt;</span> <span class="n">maxRetryCount</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">retryCount</span><span class="o">++</span><span class="p">;</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.testng.Assert</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.testng.annotations.Test</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestclassSample</span> <span class="p">{</span>

  <span class="nd">@Test</span><span class="p">(</span><span class="n">retryAnalyzer</span> <span class="o">=</span> <span class="n">MyRetry</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test2</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Assert</span><span class="p">.</span><span class="na">fail</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>实现IRetryAnalyzer接口的retry方法。</p></li>
<li><p>在&#64;Test的retryAnalyzer中指定重试类。</p></li>
</ul>
</div>
<div class="section" id="id13">
<h2>TestNG编程<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<p>除了IDEA和Maven这两种运行方式，TestNG还可以直接在程序中调用运行：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">TestListenerAdapter</span> <span class="n">tla</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TestListenerAdapter</span><span class="p">();</span>
<span class="n">TestNG</span> <span class="n">testng</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TestNG</span><span class="p">();</span>
<span class="n">testng</span><span class="p">.</span><span class="na">setTestClasses</span><span class="p">(</span><span class="k">new</span> <span class="n">Class</span><span class="o">[]</span> <span class="p">{</span> <span class="n">Run2</span><span class="p">.</span><span class="na">class</span> <span class="p">});</span>
<span class="n">testng</span><span class="p">.</span><span class="na">addListener</span><span class="p">(</span><span class="n">tla</span><span class="p">);</span>
<span class="n">testng</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>
</pre></div>
</div>
<ul class="simple">
<li><p>TestListenerAdapter是默认的，可以实现org.testng.ITestListener接口自定义TestListener。</p></li>
<li><p>setTestClasses添加测试类。</p></li>
<li><p>run()运行。</p></li>
</ul>
<p>还可以通过编程创建一个虚拟的testng.xml，org.testng.xml包的XmlClass,
XmlTest等提供了这个能力：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">XmlSuite</span> <span class="n">suite</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XmlSuite</span><span class="p">();</span>
<span class="n">suite</span><span class="p">.</span><span class="na">setName</span><span class="p">(</span><span class="s">&quot;TmpSuite&quot;</span><span class="p">);</span>

<span class="n">XmlTest</span> <span class="n">test</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XmlTest</span><span class="p">(</span><span class="n">suite</span><span class="p">);</span>
<span class="n">test</span><span class="p">.</span><span class="na">setName</span><span class="p">(</span><span class="s">&quot;TmpTest&quot;</span><span class="p">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">XmlClass</span><span class="o">&gt;</span> <span class="n">classes</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XmlClass</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">classes</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="n">XmlClass</span><span class="p">(</span><span class="s">&quot;test.failures.Child&quot;</span><span class="p">));</span>
<span class="n">test</span><span class="p">.</span><span class="na">setXmlClasses</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="p">;</span>
</pre></div>
</div>
<p>这段代码会创建一个这样的testng.xml：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;suite</span> <span class="na">name=</span><span class="s">&quot;TmpSuite&quot;</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;TmpTest&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;classes&gt;</span>
      <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;test.failures.Child&quot;</span>  <span class="nt">/&gt;</span>
    <span class="nt">&lt;classes&gt;</span>
    <span class="nt">&lt;/test&gt;</span>
<span class="nt">&lt;/suite&gt;</span>
</pre></div>
</div>
<p>XmlSuite可以通过TestNG程序调用：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">XmlSuite</span><span class="o">&gt;</span> <span class="n">suites</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XmlSuite</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">suites</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">suite</span><span class="p">);</span>
<span class="n">TestNG</span> <span class="n">tng</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TestNG</span><span class="p">();</span>
<span class="n">tng</span><span class="p">.</span><span class="na">setXmlSuites</span><span class="p">(</span><span class="n">suites</span><span class="p">);</span>
<span class="n">tng</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="xmlbeanshell">
<h2>XML中写BeanShell<a class="headerlink" href="#xmlbeanshell" title="Permalink to this headline">¶</a></h2>
<p>是的，TestNG的XML中可以写BeanShell，用来替代<code class="docutils literal notranslate"><span class="pre">&lt;include&gt;</span></code>和<code class="docutils literal notranslate"><span class="pre">&lt;exclude&gt;</span></code>：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;BeanShell test&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;method-selectors&gt;</span>
     <span class="nt">&lt;method-selector&gt;</span>
       <span class="nt">&lt;script</span> <span class="na">language=</span><span class="s">&quot;beanshell&quot;</span><span class="nt">&gt;</span><span class="cp">&lt;![CDATA[</span>
<span class="cp">         groups.containsKey(&quot;test1&quot;)</span>
<span class="cp">       ]]&gt;</span><span class="nt">&lt;/script&gt;</span>
     <span class="nt">&lt;/method-selector&gt;</span>
   <span class="nt">&lt;/method-selectors&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>CDATA用来防止跟XML标签语法冲突。</p></li>
<li><p>预置了method（当前测试方法）、testngMethod（当前测试方法的描述）、groups（当前测试方法所属分组）三个对象，可以用来做匹配。</p></li>
<li><p>使用<code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code>后，<code class="docutils literal notranslate"><span class="pre">&lt;include&gt;</span></code>和<code class="docutils literal notranslate"><span class="pre">&lt;exclude&gt;</span></code>会失效。</p></li>
</ul>
</div>
<div class="section" id="listener">
<h2>Listener<a class="headerlink" href="#listener" title="Permalink to this headline">¶</a></h2>
<p>TestNG提供了很多Listener用来自定义TestNG行为，类似于Hook那个意思：</p>
<ul class="simple">
<li><p>IAnnotationTransformer</p></li>
<li><p>IAnnotationTransformer2</p></li>
<li><p>IHookable</p></li>
<li><p>IInvokedMethodListener</p></li>
<li><p>IMethodInterceptor</p></li>
<li><p>IReporter</p></li>
<li><p>ISuiteListener</p></li>
<li><p>ITestListener</p></li>
<li><p>ITestNGListener</p></li>
<li><p>IAlterSuiteListener</p></li>
</ul>
<p>比如用IAnnotationTransformer动态设置&#64;Test属性：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyTransformer</span> <span class="kd">implements</span> <span class="n">IAnnotationTransformer</span> <span class="p">{</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ITest</span> <span class="n">annotation</span><span class="p">,</span> <span class="n">Class</span> <span class="n">testClass</span><span class="p">,</span>
      <span class="n">Constructor</span> <span class="n">testConstructor</span><span class="p">,</span> <span class="n">Method</span> <span class="n">testMethod</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="s">&quot;invoke&quot;</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">testMethod</span><span class="p">.</span><span class="na">getName</span><span class="p">()))</span> <span class="p">{</span>
      <span class="n">annotation</span><span class="p">.</span><span class="na">setInvocationCount</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<blockquote>
<div><p>如果想修改&#64;Factory或&#64;DataProvider，得用IAnnotationTransformer2。</p>
</div></blockquote>
<p>比如用IMethodInterceptor设定用例组的执行顺序：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">IMethodInstance</span><span class="o">&gt;</span> <span class="nf">intercept</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">IMethodInstance</span><span class="o">&gt;</span> <span class="n">methods</span><span class="p">,</span> <span class="n">ITestContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="n">IMethodInstance</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">IMethodInstance</span><span class="o">&gt;</span><span class="p">();</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">IMethodInstance</span> <span class="n">m</span> <span class="p">:</span> <span class="n">methods</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Test</span> <span class="n">test</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="na">getMethod</span><span class="p">().</span><span class="na">getConstructorOrMethod</span><span class="p">().</span><span class="na">getAnnotation</span><span class="p">(</span><span class="n">Test</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
    <span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">groups</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">String</span> <span class="n">group</span> <span class="p">:</span> <span class="n">test</span><span class="p">.</span><span class="na">groups</span><span class="p">())</span> <span class="p">{</span>
      <span class="n">groups</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">group</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">//让fast分组第一个执行</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">groups</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;fast&quot;</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">result</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="n">result</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>比如想自定义测试开始前和测试后的行为，可以先写个Listener：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BeforeAfterLog</span> <span class="kd">extends</span> <span class="n">TestListenerAdapter</span> <span class="p">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onTestSuccess</span><span class="p">(</span><span class="n">ITestResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;onTestSuccess&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onTestFailure</span><span class="p">(</span><span class="n">ITestResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;onTestFailure&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>然后在测试类上添加：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Listeners</span><span class="p">(</span><span class="n">BeforeAfterLog</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyTest</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>这样就不用每个测试类都写&#64;BeforeClass和&#64;AfterClass了。</p>
</div>
<div class="section" id="id14">
<h2>依赖注入<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<p>TestNG支持在测试方法中添加特定类来进行依赖注入（就是获取TestNG相关信息）：</p>
<ul class="simple">
<li><p>ITestContext</p></li>
<li><p>XmlTest 当前<code class="docutils literal notranslate"><span class="pre">&lt;test&gt;</span></code>标签</p></li>
<li><p>Method 当前调用的测试方法</p></li>
<li><p>Object[] 当前测试方法的入参</p></li>
<li><p>ITestResult 当前测试结果</p></li>
</ul>
<p>不同注解支持的方式如下表所示：</p>
<p><img alt="image8" src="../_images/image-20220114130719485.png" /></p>
<p>示例：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoInjectionTest</span> <span class="p">{</span>

  <span class="nd">@DataProvider</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;provider&quot;</span><span class="p">)</span>
  <span class="kd">public</span> <span class="n">Object</span><span class="o">[][]</span> <span class="nf">provide</span><span class="p">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[][]</span> <span class="p">{</span> <span class="p">{</span> <span class="n">CC</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getMethod</span><span class="p">(</span><span class="s">&quot;f&quot;</span><span class="p">)</span> <span class="p">}</span> <span class="p">};</span>
  <span class="p">}</span>

  <span class="nd">@Test</span><span class="p">(</span><span class="n">dataProvider</span> <span class="o">=</span> <span class="s">&quot;provider&quot;</span><span class="p">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">withoutInjection</span><span class="p">(</span><span class="nd">@NoInjection</span> <span class="n">Method</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Assert</span><span class="p">.</span><span class="na">assertEquals</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="na">getName</span><span class="p">(),</span> <span class="s">&quot;f&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nd">@Test</span><span class="p">(</span><span class="n">dataProvider</span> <span class="o">=</span> <span class="s">&quot;provider&quot;</span><span class="p">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">withInjection</span><span class="p">(</span><span class="n">Method</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Assert</span><span class="p">.</span><span class="na">assertEquals</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="na">getName</span><span class="p">(),</span> <span class="s">&quot;withInjection&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<blockquote>
<div><p>&#64;NoInjection用于禁止依赖注入。</p>
</div></blockquote>
</div>
<div class="section" id="id15">
<h2>断言<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h2>
<p>TestNG支持Java的assert关键字断言，示例：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">verifyLastName</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">assert</span> <span class="s">&quot;Beust&quot;</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">m_lastName</span><span class="p">)</span> <span class="p">:</span> <span class="s">&quot;Expected name Beust, for&quot;</span> <span class="o">+</span> <span class="n">m_lastName</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>也可以用JUnit断言方法：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import static</span> <span class="nn">org.testng.AssertJUnit.*</span><span class="p">;</span>
<span class="c1">//...</span>
<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">verify</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">assertEquals</span><span class="p">(</span><span class="s">&quot;Beust&quot;</span><span class="p">,</span> <span class="n">m_lastName</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id16">
<h2>日志<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<p>用Listener来实现，直接看代码：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DotTestListener</span> <span class="kd">extends</span> <span class="n">TestListenerAdapter</span> <span class="p">{</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">m_count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onTestFailure</span><span class="p">(</span><span class="n">ITestResult</span> <span class="n">tr</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">log</span><span class="p">(</span><span class="s">&quot;F&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onTestSkipped</span><span class="p">(</span><span class="n">ITestResult</span> <span class="n">tr</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">log</span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onTestSuccess</span><span class="p">(</span><span class="n">ITestResult</span> <span class="n">tr</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">log</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">log</span><span class="p">(</span><span class="n">String</span> <span class="n">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">string</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="n">m_count</span> <span class="o">%</span> <span class="mi">40</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id17">
<h2>测试报告<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h2>
<p>TestNG自带了一个测试报告，运行完后会生成index.html，打开就是，比较丑，推荐用Allure。</p>
<p>如果想获取测试报告的数据，那么可以从org.testng.IReporter接口的方法：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">generateReport</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">ISuite</span><span class="o">&gt;</span> <span class="n">suites</span><span class="p">,</span> <span class="n">String</span> <span class="n">outputDirectory</span><span class="p">)</span>
</pre></div>
</div>
<p>根据它的入参去拿。</p>
<p>如果想给测试报告添加数据，那么可以使用org.testng.Reporter类：</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Reporter</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="s">&quot;M3 WAS CALLED&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="yamlxml">
<h2>YAML替代XML<a class="headerlink" href="#yamlxml" title="Permalink to this headline">¶</a></h2>
<p>如果你烦透了XML，那么可以试试YAML。</p>
<p>比如XML：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;suite</span> <span class="na">name=</span><span class="s">&quot;SingleSuite&quot;</span> <span class="na">verbose=</span><span class="s">&quot;2&quot;</span> <span class="na">thread-count=</span><span class="s">&quot;4&quot;</span><span class="nt">&gt;</span>

  <span class="nt">&lt;parameter</span> <span class="na">name=</span><span class="s">&quot;n&quot;</span> <span class="na">value=</span><span class="s">&quot;42&quot;</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;test</span> <span class="na">name=</span><span class="s">&quot;Regression2&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;groups&gt;</span>
      <span class="nt">&lt;run&gt;</span>
        <span class="nt">&lt;exclude</span> <span class="na">name=</span><span class="s">&quot;broken&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/run&gt;</span>
    <span class="nt">&lt;/groups&gt;</span>

    <span class="nt">&lt;classes&gt;</span>
      <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;test.listeners.ResultEndMillisTest&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/classes&gt;</span>
  <span class="nt">&lt;/test&gt;</span>
<span class="nt">&lt;/suite&gt;</span>
</pre></div>
</div>
<p>换成YAML：</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SingleSuite</span>
<span class="nt">threadCount</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="nt">parameters</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt"> n</span><span class="p">:</span> <span class="nv">42</span> <span class="p p-Indicator">}</span>

<span class="nt">tests</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Regression2</span>
    <span class="nt">parameters</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt"> count</span><span class="p">:</span> <span class="nv">10</span> <span class="p p-Indicator">}</span>
    <span class="nt">excludedGroups</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="nv">broken</span> <span class="p p-Indicator">]</span>
    <span class="nt">classes</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">test.listeners.ResultEndMillisTest</span>
</pre></div>
</div>
<p>舒服多了。不过TestNG本身没有引入YAML依赖包，需要自己添加：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupid&gt;</span>org.yaml<span class="nt">&lt;/groupid&gt;</span>
  <span class="nt">&lt;artifactid&gt;</span>snakeyaml<span class="nt">&lt;/artifactid&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.23<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="id18">
<h2>彩蛋<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h2>
<p>看完了官方教程，感觉测试框架的功能基本上大同小异，只是技术实现上有所区别。让我惊喜的是，TestNG运行失败的用例可以自动生成一份失败用例的xml文件，直接拿来重跑就可以了。还有一直以为TestNG只能用XML，没想到也能用YAML了。最后，它给出了<code class="docutils literal notranslate"><span class="pre">-Dtestng.mode.dryrun=true</span></code>这个参数，猜猜它是干嘛的。有时候只想看跑起来会执行哪些测试，而不想真正执行，那么就可以用这个参数。</p>
<p><img alt="image9" src="../_images/image-20220114135434195.png" /></p>
<blockquote>
<div><p>参考资料：</p>
<p><a class="reference external" href="https://testng.org/doc/">https://testng.org/doc/</a></p>
<p><a class="reference external" href="https://testng.org/doc/documentation-main.html">https://testng.org/doc/documentation-main.html</a></p>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="301-HttpRunner3%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90__init__%E6%96%87%E4%BB%B6%E5%B9%B2%E4%BA%86%E4%BA%9B%E5%95%A5.html" class="btn btn-neutral float-right" title="HttpRunner3源码剖析__init__文件干了些啥" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="007-pytest%E7%94%A8%E4%BE%8B%E6%9F%A5%E6%89%BE%E5%8E%9F%E7%90%86.html" class="btn btn-neutral float-left" title="pytest用例查找原理" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 测试开发刚哥

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>